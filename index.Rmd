---
title: "Flex Dashboard Example"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(knitr)
library(shiny)
library(crosstalk)
library(DT)
library(plotly)
knitr::opts_chunk$set(message=FALSE,warning=FALSE, cache=F)
testdata <- read.csv("EloDashData.csv")
testdata <- testdata[,-1]
testdata$date<-as.Date(testdata$date,format="%Y-%m-%d")
testdata$year <- as.character(testdata$year)
tdata <- SharedData$new(testdata)
rank <- read.csv("EloRank25.csv")
```

Inputs {.sidebar}
-----------------------------------------------------------------------

```{r}
filter_select("name", "Choose Player", tdata, ~name)
```

```{r}
filter_select("year", "Choose Year", tdata, ~year)
```

Column {data-width=500}
-----------------------------------------------------------------------

### Chart A

```{r}
datatable(tdata,
          class = "compact cell-border",
          rownames = FALSE,
          options = list(order = list(1, "desc"),
                         autoWidth = FALSE,
                         pageLength = 20))
```

Column {data-width=500}
-----------------------------------------------------------------------

### Plot of Elo by Player and Year

```{r}
g <- ggplot(tdata,aes(date,Etot,group=name)) + 
  geom_line(aes(color=name))

ggplotly(g)%>%
    layout(showlegend = F)
```

### Current Top-25 Players Ranked

```{r}
q <- ggplot(rank,aes(x=reorder(name,-Etot),y=Etot,color=name)) + 
  geom_bar(stat="identity")+
  coord_cartesian(ylim=c((min(rank$Etot)-100),(max(rank$Etot)+50)))+
  theme(axis.text.x=element_blank())

ggplotly(q)%>%
    layout(showlegend = F)
```

